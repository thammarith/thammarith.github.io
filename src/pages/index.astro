---
import { renderImg } from 'astro-imagetools/api';

// import RevueNewsLetter from '@components/RevueNewsLetter/RevueNewsLetter.tsx';
import BlogBlock from '@components/BlogBlock/BlogBlock.tsx';
import Footer from '@components/Footer/Footer.tsx';
import { allArticles_published_forThumbnail, getImageUrl, getBlogUrl, baseUrl } from '@constants/urls.ts';
import Layout from '@layouts/GlobalLayout.astro'

const result = await fetch(allArticles_published_forThumbnail).then(res => res.json());
const data = result.data.map(({ id, title, cover_image, slug, date_created }) => ({
	id, title, slug, date_created,
	coverImage: getImageUrl(cover_image),
	url: getBlogUrl(Astro.canonicalURL.origin ?? baseUrl, slug),
}));

const _publishedEntries = await Promise.all(data.map(async e => {
	const { link, style, img } = await renderImg({
		src: e.coverImage,
		alt: '',
		aspect: 16 / 9,
	});

	return { ...e, mappedImage: { link, style, img } }
}));

const publishedEntries = [
	..._publishedEntries,
	..._publishedEntries,
	..._publishedEntries,
	..._publishedEntries,
	..._publishedEntries,
	..._publishedEntries,
	..._publishedEntries,
]

---

<Layout>
	<!-- <nav class="fixed top-0 w-screen bg-orange-500 h-16 drop-shadow">
		this is nav bar
	</nav> -->

	<section class="HomepagePanel min-h-[32rem] h-[90vh] bg-slate-900">
		<h1 class="font-heading text-slate-100 text-6xl leading-[3rem]">
			Thammarith
			<br />
			Likittheerameth
		</h1>
		<div class="font-['Bitter'] text-slate-400 text-xl font-medium mt-6">
			Full-stack Software Engineer at Agoda
		</div>

		<div class="font-text text-slate-400 max-w-md mt-12">
			<p>
				Coding and having existential crisis concurrently
				<!-- Most of the time, I'm debugging and fixing bug my yesterday's self has introduced unknowingly. -->
			</p>
			<p class="mt-3">
				My home is <code>localhost:3000</code> built with my handy tools: React, TypeScript, C#, SQL, bugs, and unintended features.
			</p>
		</div>

		<div class="mt-6 text-slate-200">
			<a class="SocialButton" href="https://linkedin.com/in/thammarith"><i class="fab fa-linkedin-in"></i></a>
			<a class="SocialButton" href="https://twitter.com/thammarith"><i class="fab fa-twitter"></i></a>
			<a class="SocialButton" href="https://github.com/thammarith"><i class="fab fa-github"></i></a>
			<a class="SocialButton" href="https://instagram.com/thammarith"><i class="fab fa-instagram"></i></a>
			<a class="SocialButton" href="https://medium.com/@thammarith"><i class="fab fa-medium-m"></i></a>
		</div>

		<div class="font-text text-slate-500 text-sm mt-24 flex items-center">
			<div class="animate-bounce">
				<i class="fa-solid fa-arrow-down w-4 h-4"></i>
			</div>
			<div class="ml-2 pb-1">
				Scroll down for about me, blog posts, and cat images
			</div>
		</div>
	</section>

	<div class="HomepagePanel">

		<BlogBlock entries={publishedEntries} />
		<!-- <RevueNewsLetter /> -->

	</div>

	<Footer client:visible />
</Layout>

<style lang="scss">
.HomepagePanel {
	@apply p-8 pt-16 md:p-32 lg:px-80;

	&.FullScreen {
		@apply min-h-screen;
	}
}

.SocialButton {
	@apply -ml-2 mr-2 h-10 w-10 text-2xl rounded-sm;
	@apply inline-flex items-center justify-center;
	@apply hover:bg-slate-100 hover:text-blue-900;
}
</style>
